# 表达式识别与计算

**引言**

人类可读的表达式是一个中缀表达式。为了方便计算机进行正确的运算，需要转为后缀表达式或者前缀表达式。在传统的转换过程中，操作的对象被细分为操作数和被操作数，而不是**表达式**。实现表达式识别与计算的目的是：让操作的对象进行组合，形成以表达式为单位的对象，使其具备基本元素以及计算需求的同时支持一些高级操作：表达式的组合、拓展、修改。

为了能够方便对表达式进行操作，需要将表达式视作对象，进行抽象，设计为类或接口。

**分析**

表达式的基本组成就是**操作符**和**被操作数**。在中缀表达式中，一个操作符位于两个操作数的中间，从左至右，分别是第一、二个操作数，操作符将两个操作数进行处理或返回一个值。返回的值可以继续作为被操作数参与计算。

在需要处理优先级顺序的表达式中，优先进行计算的表达式可以作为**子表达式**，子表达式不直接参与计算，参与计算的是它的**值**。对于任何复杂的表达式，在它眼中，最后都是以**操作符**和**被操作数**为成分的基本表达式，乃至其本身在另外任何的表达中，也是以**值**的形式充当表达式中的**被操作数**。

> 被操作数 = 子表达式的值；
>
> 子表达式的值 = 子表达式中的所有操作符与被操作数的运算结果，此时值有两种依据
>
> - 至少一个操作符，直接进行运算得到值
> - 只有一个操作数，没有操作符，本身即是数值。

操作符的基本特征是能够连接两个操作数，换句话说，操作符的对象类似于一种**函数**接口，将输入的两个参数进行处理并返回处理的**结果**，即一个基本表达式的**值**。

可以说，一个表达式至少需要一个操作数（本身作为数值）。

> 在Java的基本类型中，关于数值的有一下6个：
>
> ```java
> byte b;
> short s;
> int i;
> long l;
> float f;
> double d;
> ```
>
> 包装类有：`Integer`， `Long`， `Double`。在表达式中，操作数的数据类型是不确定的，可能是 `int` ，也可能是 `double`。而且 `double` 在运算中可能会产生精度问题。如何兼容不同类型的操作数似乎也是需要探讨的细节。

当操作数不止一个时，就需要添加操作符，使表达式完整且具有意义。表达式应当还需要有 `append` 或其他相似的操作，来对原本的表达式进行**拓展**。

**总结**

表达式须有的属性：

1. 拥有的子表达式（只有一个操作数时，视作没有子表达式）
2. 连接子表达式的操作符
3. 表达式的值（只有一个操作数时，该操作数的值）
4. 能够进行拓展

操作符的属性：

1. 能够接收两个表达式
2. 能够处理两个表达式进行输出，且类型为数值（或称为只有一个操作数的表达式）
